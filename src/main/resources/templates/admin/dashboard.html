<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="admin, dashboard, ecommerce, panel" />
	<meta name="description" content="Carrot - Admin.">
	<meta name="author" content="ashishmaraviya">

	<title>Admin - Dashboard</title>

	<!-- App favicon -->
	<link rel="shortcut icon" th:href="@{/admin/img/favicon/favicon.ico}">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">

	<!-- Icon CSS -->
	<link th:href="@{/admin/css/vendor/materialdesignicons.min.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/remixicon.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/owl.carousel.min.css}" rel="stylesheet">

	<!-- Vendor CSS -->
	<link th:href="@{/admin/css/vendor/datatables.bootstrap5.min.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/responsive.datatables.min.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/daterangepicker.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/simplebar.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/bootstrap.min.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/apexcharts.css}" rel="stylesheet">
	<link th:href="@{/admin/css/vendor/jquery-jvectormap-1.2.2.css}" rel="stylesheet">

	<!-- Main CSS -->
	<link id="main-css" th:href="@{/admin/css/style.css}" rel="stylesheet">

	<style>
		.notification-banner {
			display: flex;
			justify-content: space-between;
			flex-direction: column;
			background-color: #007bff;
			color: white;
			padding: 15px 20px;
			border-radius: 10px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
			font-size: 15px;
			margin-bottom: 12px;
			animation: fadeInDown 0.5s ease-in-out;
			position: relative;
		}

		.notification-banner .close-btn {
			position: absolute;
			top: 5px;
			right: 10px;
			font-size: 18px;
			font-weight: bold;
			color: white;
			background: none;
			border: none;
			cursor: pointer;
		}

		@keyframes fadeInDown {
			from {
				opacity: 0;
				transform: translateY(-20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
	</style>


</head>

<body>
<main class="wrapper sb-default ecom">
	<!-- Loader -->
	<div id="cr-overlay">
		<div class="loader"></div>
	</div>

	<!-- fragment header -->
	<div th:replace="~{admin/header :: header}"></div>
	<!-- fragment sidebar -->
	<div th:replace="~{admin/sidebar :: sidebar}"></div>

	<!-- Nội dung chính -->
	<div class="cr-main-content">
		<div class="container-fluid">
			<!-- Page title & breadcrumb -->
			<div class="cr-page-title">
				<div class="cr-breadcrumb">
					<h5>eCommerce</h5>
					<ul>
						<li><a th:href="@{/index.html}">Carrot</a></li>
						<li>eCommerce</li>
					</ul>
				</div>
				<div class="cr-tools">
					<div id="pagedate">
						<div class="cr-date-range" title="Date">
							<span></span>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-xl-12">
					<div class="row">
						<div class="col-xl-3 col-md-6">
							<div class="cr-card">
								<div class="cr-card-content label-card">
									<div class="title">
										<span class="icon icon-1"><i class="ri-shield-user-line"></i></span>
										<div class="growth-numbers">
											<h4>Customers</h4>
											<h5>857k</h5>
										</div>
									</div>
									<p class="card-groth up">
										<i class="ri-arrow-up-line"></i>
										32%
										<span>Last Month</span>
									</p>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-md-6">
							<div class="cr-card">
								<div class="cr-card-content label-card">
									<div class="title">
										<span class="icon icon-2"><i class="ri-shopping-bag-3-line"></i></span>
										<div class="growth-numbers">
											<h4>Order</h4>
											<h5>08.65k</h5>
										</div>
									</div>
									<p class="card-groth down">
										<i class="ri-arrow-down-line"></i>
										1.7%
										<span>Last Month</span>
									</p>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-md-6">
							<div class="cr-card">
								<div class="cr-card-content label-card">
									<div class="title">
										<span class="icon icon-3"><i class="ri-money-dollar-circle-line"></i></span>
										<div class="growth-numbers">
											<h4>Revenue</h4>
											<h5>$85746</h5>
										</div>
									</div>
									<p class="card-groth down">
										<i class="ri-arrow-down-line"></i>
										3.8%
										<span>Last Month</span>
									</p>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-md-6">
							<div class="cr-card">
								<div class="cr-card-content label-card">
									<div class="title">
										<span class="icon icon-4"><i class="ri-exchange-dollar-line"></i></span>
										<div class="growth-numbers">
											<h4>Expenses</h4>
											<h5>$75462</h5>
										</div>
									</div>
									<p class="card-groth up">
										<i class="ri-arrow-up-line"></i>
										8%
										<span>Last Month</span>
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer>
		<div class="container-fluid">
			<div class="copyright">
				<p><span id="copyright_year"></span> © Carrot, All rights Reserved.</p>
				<p>Design by MaraviyaInfotech.</p>
			</div>
		</div>
	</footer>
</main>
<div id="notificationContainer"
	 style="position: fixed; top: 20px; right: 20px; z-index: 9999; max-width: 400px;">
</div>

<script th:src="@{/admin/js/vendor/jquery-3.6.4.min.js}"></script>
<script th:src="@{/admin/js/vendor/simplebar.min.js}"></script>
<script th:src="@{/admin/js/vendor/bootstrap.bundle.min.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

<script type="text/javascript">
	const container = document.getElementById("notificationContainer");

	function showBanner(message, time) {
		const banner = document.createElement("div");
		banner.className = "notification-banner";

		const dateTime = time || new Date().toLocaleString();

		banner.innerHTML = `
			<div><strong>${message}</strong><br><small>${dateTime}</small></div>
			<button class="close-btn" onclick="hideBanner(this.parentElement)">&times;</button>
		`;

		container.appendChild(banner);

		setTimeout(() => {
			banner.remove();
		}, 31536000);
	}

	function hideBanner(banner) {
		banner.remove();
	}

	document.addEventListener('DOMContentLoaded', () => {
		const stored = localStorage.getItem("notifications");
		if (stored) {
			const notifications = JSON.parse(stored);
			notifications.forEach(n => showBanner(n.message, n.time));
		}
	});

	const socket = new SockJS('/websocket');
	const stompClient = Stomp.over(socket);

	stompClient.connect({}, function (frame) {
		console.log('Connected: ' + frame);
		stompClient.subscribe('/topic/admin', function (messageOutput) {
			const msg = messageOutput.body;
			const time = new Date().toLocaleString();
			showBanner(msg, time);

			let notifications = JSON.parse(localStorage.getItem('notifications')) || [];
			notifications.push({ message: msg, time: time });
			localStorage.setItem('notifications', JSON.stringify(notifications));
		});
	});
</script>


<!-- Data Tables -->
<script th:src="@{/admin/js/vendor/jquery.datatables.min.js}"></script>
<script th:src="@{/admin/js/vendor/datatables.bootstrap5.min.js}"></script>
<script th:src="@{/admin/js/vendor/datatables.responsive.min.js}"></script>

<!-- Calendar -->
<script th:src="@{/admin/js/vendor/jquery.simple-calendar.js}"></script>

<!-- Date Range Picker -->
<script th:src="@{/admin/js/vendor/moment.min.js}"></script>
<script th:src="@{/admin/js/vendor/daterangepicker.js}"></script>
<script th:src="@{/admin/js/vendor/date-range.js}"></script>

<!-- Main Custom -->
<script th:src="@{/admin/js/main.js}"></script>
<script th:src="@{/admin/js/data/ecommerce-chart-data.js}"></script>

</body>
</html>
